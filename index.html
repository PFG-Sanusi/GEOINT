<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PF-GEOINT Solutions</title>
  <style>
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 50%, #0d1b2a 100%);
      background-size: 200% 200%;
      animation: gradientShift 12s ease-in-out infinite;
      color: #e0e0e0;
      overflow-x: hidden;
    }
    .container {
      max-width: 1500px;
      margin: 0 auto;
      padding: 30px;
    }
    .header {
      text-align: center;
      padding: 72px 0;
      background: radial-gradient(1200px 400px at 50% -10%, rgba(0,212,255,0.15), transparent 70%),
                  linear-gradient(180deg, #14233d 0%, #0f1b2e 100%);
      position: relative;
      overflow: hidden;
      border-bottom: 1px solid rgba(0, 212, 255, 0.1);
    }
    .header h1 {
      margin: 0;
      font-size: 3.5em;
      font-weight: 800;
      color: #00d4ff;
      text-transform: uppercase;
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
      animation: fadeIn 1s ease-in-out;
    }
    .header::before {
      content: '';
      position: absolute;
      top: -80px;
      left: -80px;
      width: 300px;
      height: 300px;
      background: radial-gradient(circle at 30% 30%, rgba(0,212,255,0.35), transparent 60%);
      filter: blur(12px);
      animation: floatBlob 10s ease-in-out infinite alternate;
    }
    .header::after {
      content: '';
      position: absolute;
      bottom: -100px;
      right: -120px;
      width: 360px;
      height: 360px;
      background: radial-gradient(circle at 70% 70%, rgba(123,0,255,0.25), transparent 60%);
      filter: blur(14px);
      animation: floatBlob 12s ease-in-out infinite alternate-reverse;
    }
    .intro {
      text-align: center;
      padding: 40px 20px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      margin: 20px 0;
      animation: slideIn 0.8s ease-out;
    }
    .intro p {
      font-size: 1.3em;
      max-width: 900px;
      margin: 0 auto;
      line-height: 1.6;
      color: #b0c4de;
    }
    .products {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 25px;
      padding: 30px 0;
    }
    .product-card {
      background: rgba(17, 30, 54, 0.55);
      border-radius: 16px;
      padding: 28px;
      text-align: center;
      transition: transform 300ms ease, box-shadow 300ms ease, border-color 300ms ease;
      position: relative;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(0, 212, 255, 0.15);
      backdrop-filter: blur(8px);
    }
    .product-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 18px 40px rgba(0, 212, 255, 0.25);
      border-color: rgba(0, 212, 255, 0.35);
    }
    .product-card::before {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(600px 200px at 50% -60%, rgba(0,212,255,0.12), transparent 60%);
      opacity: 0;
      transition: opacity 300ms ease;
    }
    .product-card:hover::before {
      opacity: 1;
    }
    .product-card h3 {
      margin: 0 0 15px;
      font-size: 1.6em;
      color: #00d4ff;
      font-weight: 600;
    }
    .product-card p {
      font-size: 0.95em;
      color: #a0b0c0;
      line-height: 1.5;
      margin-bottom: 20px;
    }
    .product-card button {
      position: relative;
      background: linear-gradient(90deg, #00d4ff, #7b00ff);
      color: white;
      border: none;
      padding: 12px 26px;
      border-radius: 28px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      text-transform: uppercase;
      transition: transform 200ms ease, box-shadow 200ms ease;
      box-shadow: 0 6px 18px rgba(0, 212, 255, 0.25);
      overflow: hidden;
    }
    .product-card button:hover {
      box-shadow: 0 10px 26px rgba(0, 212, 255, 0.35);
      transform: translateY(-2px);
    }
    .product-card button:active { transform: translateY(0); }
    .product-card button .ripple {
      position: absolute;
      border-radius: 50%;
      transform: scale(0);
      animation: ripple 600ms linear;
      background: rgba(255,255,255,0.7);
      pointer-events: none;
    }
    .back-button {
      position: relative;
      background: linear-gradient(90deg, #ff00ff, #00d4ff);
      color: white;
      border: none;
      padding: 12px 26px;
      border-radius: 28px;
      cursor: pointer;
      font-size: 1em;
      font-weight: 600;
      text-transform: uppercase;
      transition: transform 200ms ease, box-shadow 200ms ease;
      margin-top: 20px;
      box-shadow: 0 6px 18px rgba(255, 0, 255, 0.25);
      overflow: hidden;
    }
    .back-button:hover {
      box-shadow: 0 10px 26px rgba(255, 0, 255, 0.35);
      transform: translateY(-2px);
    }
    .back-button .ripple { position: absolute; border-radius: 50%; transform: scale(0); animation: ripple 600ms linear; background: rgba(255,255,255,0.7); pointer-events: none; }
    
    /* AI Chatbot Styles */
    .chatbot-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      width: 350px;
      max-height: 500px;
      background: rgba(17, 30, 54, 0.95);
      border: 1px solid rgba(0, 212, 255, 0.3);
      border-radius: 16px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }
    .chatbot-container.open {
      transform: translateY(0);
    }
    .chatbot-header {
      background: linear-gradient(90deg, #00d4ff, #7b00ff);
      color: white;
      padding: 12px 16px;
      border-radius: 16px 16px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }
    .chatbot-header h3 {
      margin: 0;
      font-size: 1.1em;
      font-weight: 600;
    }
    .chatbot-toggle {
      background: none;
      border: none;
      color: white;
      font-size: 1.2em;
      cursor: pointer;
      padding: 4px;
    }
    .chatbot-messages {
      height: 300px;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .chatbot-message {
      max-width: 80%;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 0.9em;
      line-height: 1.4;
    }
    .chatbot-message.user {
      background: rgba(0, 212, 255, 0.2);
      color: #e0e0e0;
      align-self: flex-end;
      border: 1px solid rgba(0, 212, 255, 0.3);
    }
    .chatbot-message.bot {
      background: rgba(255, 255, 255, 0.1);
      color: #bcd1e6;
      align-self: flex-start;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .chatbot-input-container {
      padding: 12px 16px;
      border-top: 1px solid rgba(0, 212, 255, 0.2);
      display: flex;
      gap: 8px;
    }
    .chatbot-input {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(0, 212, 255, 0.3);
      border-radius: 20px;
      padding: 8px 14px;
      color: #e0e0e0;
      font-size: 0.9em;
      outline: none;
    }
    .chatbot-input::placeholder {
      color: #a0b0c0;
    }
    .chatbot-send {
      background: linear-gradient(90deg, #00d4ff, #7b00ff);
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1em;
      transition: transform 0.2s ease;
    }
    .chatbot-send:hover {
      transform: scale(1.05);
    }
    .chatbot-send:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .chatbot-typing {
      display: none;
      align-items: center;
      gap: 4px;
      padding: 10px 14px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      max-width: 80px;
      align-self: flex-start;
    }
    .chatbot-typing span {
      width: 6px;
      height: 6px;
      background: #00d4ff;
      border-radius: 50%;
      animation: typing 1.4s infinite ease-in-out;
    }
    .chatbot-typing span:nth-child(2) { animation-delay: 0.2s; }
    .chatbot-typing span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-10px); }
    }
    .image-container {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 20px;
    }
    .image-card {
      background: #1e2a44;
      border-radius: 12px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      max-width: 48%;
    }
    .image-card img {
      width: 100%;
      max-height: 700px;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 212, 255, 0.2);
      object-fit: contain;
      cursor: zoom-in;
    }
    .image-card p.note {
      font-size: 0.9em;
      color: #ff6666;
      margin-top: 10px;
    }
    /* Before-After comparison */
    .compare-card {
      background: rgba(17, 30, 54, 0.55);
      border: 1px solid rgba(0, 212, 255, 0.15);
      border-radius: 16px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      backdrop-filter: blur(8px);
      width: 100%;
      max-width: 1200px;
      margin: 6px auto 16px;
    }
    .ba-container {
      position: relative;
      width: 100%;
      overflow: hidden;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 212, 255, 0.2);
      background: #0f1b2e;
    }
    .ba-wrapper { position: relative; width: 100%; height: 100%; }
    .ba-bottom, .ba-top img { display: block; width: 100%; height: auto; user-select: none; }
    .ba-top { position: absolute; inset: 0; width: 50%; overflow: hidden; }
    .ba-divider {
      position: absolute;
      top: 0; bottom: 0;
      width: 2px;
      background: rgba(0, 212, 255, 0.9);
      box-shadow: 0 0 12px rgba(0, 212, 255, 0.5);
      transform: translateX(-1px);
      pointer-events: none;
    }
    .ba-handle {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 22px; height: 22px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00d4ff, #7b00ff);
      box-shadow: 0 6px 18px rgba(0,0,0,0.35);
      border: 2px solid rgba(255,255,255,0.85);
      pointer-events: none;
    }
    .ba-controls { display: flex; align-items: center; gap: 12px; margin-top: 12px; }
    .ba-controls label { color: #bcd1e6; font-size: 0.95em; }
    .ba-range { flex: 1; appearance: none; -webkit-appearance: none; height: 6px; border-radius: 999px; background: rgba(255,255,255,0.15); outline: none; }
    .ba-range::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #00d4ff; border: 2px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.35); cursor: pointer; }
    .ba-range::-moz-range-thumb { width: 18px; height: 18px; border-radius: 50%; background: #00d4ff; border: 2px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.35); cursor: pointer; }
    /* Interpretation/info card */
    .info-card {
      text-align: left;
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(0, 212, 255, 0.15);
      border-radius: 10px;
      padding: 14px 16px;
      margin-top: 14px;
    }
    .info-card h4 {
      margin: 0 0 8px 0;
      color: #00d4ff;
      font-size: 1.05em;
      font-weight: 600;
    }
    .info-card ul {
      margin: 8px 0 0 18px;
      padding: 0;
      color: #bcd1e6;
      line-height: 1.5;
      font-size: 0.95em;
    }
    .info-card li b { color: #e8f4ff; }
    /* Summary/conclusion card */
    .summary-card {
      background: rgba(255, 255, 255, 0.04);
      border: 1px solid rgba(0, 212, 255, 0.18);
      border-radius: 14px;
      padding: 18px 20px;
      margin: 24px 0 8px 0;
      box-shadow: 0 8px 28px rgba(0,0,0,0.25);
    }
    .summary-card h3 {
      margin: 0 0 10px 0;
      color: #7adfff;
      font-size: 1.25em;
      letter-spacing: 0.3px;
    }
    .summary-card ul {
      margin: 10px 0 0 18px;
      padding: 0;
      color: #c8d8ea;
      line-height: 1.6;
      font-size: 1em;
    }
    .summary-card p { color: #bcd1e6; margin: 12px 0 0 0; }
    /* Image modal (click-to-zoom) */
    .img-modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(2px);
    }
    .img-modal img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 90vw;
      max-height: 90vh;
      border-radius: 10px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
    }
    .img-modal .close {
      position: absolute;
      top: 16px;
      right: 24px;
      font-size: 32px;
      color: #ffffff;
      cursor: pointer;
      user-select: none;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes floatBlob {
      0% { transform: translate(0, 0) scale(1); }
      100% { transform: translate(40px, 30px) scale(1.08); }
    }
    @keyframes ripple {
      to { transform: scale(4); opacity: 0; }
    }
    @keyframes zoomIn {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.92); }
      to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    @media (max-width: 600px) {
      .header h1 {
        font-size: 2.2em;
      }
      .intro p {
        font-size: 1.1em;
      }
      .products {
        grid-template-columns: 1fr;
      }
      .product-card {
        padding: 20px;
      }
      .image-card {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>PF-GEOINT Solutions</h1>
  </div>
  <div class="container">
    <div class="intro">
      <p>Discover PF-GEOINT, our state-of-the-art Geospatial Intelligence platform. Powered by advanced satellite imagery, AI-driven analytics, and real-time data, our solutions transform decision-making across industries.</p>
    </div>
    <div id="main-products" class="products">
      <div class="product-card">
        <h3>Defense & Security</h3>
        <p>Advanced surveillance, threat detection, and mission planning with high-resolution imagery and AI-powered insights.</p>
        <button onclick="learnMore('defense')">Explore Now</button>
      </div>
      <div class="product-card">
        <h3>Agriculture</h3>
        <p>Boost yields with precision farming, soil analysis, and real-time weather monitoring for smarter agriculture.</p>
        <button onclick="learnMore('agriculture')">Explore Now</button>
      </div>
      <div class="product-card">
        <h3>Urban Planning</h3>
        <p>Design future-ready cities with 3D mapping, infrastructure monitoring, and population analytics.</p>
        <button onclick="learnMore('urban-planning')">Explore Now</button>
      </div>
      <div class="product-card">
        <h3>Environmental Monitoring</h3>
        <p>Track climate change, deforestation, and resources with cutting-edge GEOINT analytics.</p>
        <button onclick="learnMore('environment')">Explore Now</button>
      </div>
      <div class="product-card">
        <h3>Transportation & Logistics</h3>
        <p>Optimize routes and enhance logistics with real-time traffic analysis and geospatial data.</p>
        <button onclick="learnMore('transportation')">Explore Now</button>
      </div>
      <div class="product-card">
        <h3>Energy & Utilities</h3>
        <p>Monitor pipelines, renewable energy sites, and grid performance with precision geospatial tools.</p>
        <button onclick="learnMore('energy')">Explore Now</button>
      </div>
    </div>

    <!-- Agriculture Solutions Section -->
    <div id="agriculture-solutions" style="display: none;">
      <h2 style="text-align: center; color: #00d4ff;">Agriculture Solutions</h2>
      <div class="products">
        <div class="product-card">
          <h3>Crop Health Assessment</h3>
          <p>Evaluate crop vitality and water stress using advanced indices like NDVI and NDWI for your area of interest.</p>
          <button onclick="showCropHealth()">View Details</button>
        </div>
        <!-- Add more agriculture solutions here as needed -->
      </div>
      <div style="text-align: center;">
        <button class="back-button" onclick="backToMain()">Back to Sectors</button>
      </div>
    </div>

    <!-- Defense & Security Solutions Section -->
    <div id="defense-solutions" style="display: none;">
      <h2 style="text-align: center; color: #00d4ff;">Defense & Security Solutions</h2>
      <div class="products">
        <div class="product-card">
          <h3>PF-GEOTRACE</h3>
          <p>Cutting-edge geolocation platform redefining tactical dominance. Fuses real-time GPS precision, dynamic marker systems, and strategic buffer zones to transform coordinates into mission-critical intelligence.</p>
          <button onclick="showGeoTrace()">View Details</button>
        </div>
        <!-- Add more defense solutions here as needed -->
      </div>
      <div style="text-align: center;">
        <button class="back-button" onclick="backToMain()">Back to Sectors</button>
      </div>
    </div>

    <!-- PF-GEOTRACE Section -->
    <div id="geotrace" style="display: none;">
      <h2 style="text-align: center; color: #00d4ff;">PF-GEOTRACE</h2>
      <div class="image-container">
        <div class="image-card" style="max-width: 100%;">
          <h3>PF-GEOTRACE Platform</h3>
          <p>Cutting-edge geolocation platform redefining tactical dominance</p>
          <img id="geotraceImage" src="https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/geotrace.jpeg" alt="PF-GEOTRACE Platform" style="width: 100%; max-height: 500px; height: auto; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 212, 255, 0.2); object-fit: contain; cursor: zoom-in;">
          <p class="note">PF-GEOTRACE platform interface</p>
          <div class="info-card">
            <h4>Platform Features</h4>
            <ul>
              <li><b>Real-time GPS Precision</b>: Ultra-accurate location tracking and positioning</li>
              <li><b>Dynamic Marker Systems</b>: Interactive markers for tactical operations</li>
              <li><b>Strategic Buffer Zones</b>: Customizable security and operational boundaries</li>
              <li><b>Satellite Imagery</b>: High-resolution satellite data integration</li>
              <li><b>Versatile Map Layers</b>: Multiple mapping options for different scenarios</li>
              <li><b>Rapid Data Export</b>: Quick export capabilities for mission-critical data</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="summary-card">
        <h3>PF-GEOTRACE â€“ Mission-Critical Intelligence</h3>
        <p><b>PF-GEOTRACE</b> is a cutting-edge geolocation platform redefining tactical dominance. It fuses real-time GPS precision, dynamic marker systems, and strategic buffer zones to transform coordinates into mission-critical intelligence. With satellite imagery, versatile map layers, and rapid data export, it's engineered for unparalleled operational superiority.</p>
        <p><b>Applications:</b> Military operations, border security, tactical surveillance, mission planning, emergency response, and critical infrastructure protection.</p>
      </div>
      <div style="text-align: center;">
        <button class="back-button" onclick="backToDefense()">Back to Defense Solutions</button>
      </div>
    </div>

    <!-- Crop Health Assessment Section -->
    <div id="crop-health" style="display: none;">
      <h2 style="text-align: center; color: #00d4ff;">Crop Health Assessment</h2>
      <div class="image-container">
        <div class="image-card">
          <h3>NDVI Map</h3>
          <p>Normalized Difference Vegetation Index showing crop vigor.</p>
          <div id="ndviContainer">
            <img id="ndviImage" src="https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDVI_NEW.png" alt="NDVI Map">
            <div id="ndviControls" style="margin-top: 10px;">
              <button onclick="toggleNDVIView()" style="background: linear-gradient(90deg, #00d4ff, #7b00ff); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.9em; font-weight: 500;">Next: 3D View</button>
            </div>
          </div>
          <p class="note">Static NDVI image from repository.</p>
          <div class="info-card">
            <h4>NDVI Interpretation (Range: -0.099 to 0.423)</h4>
            <ul>
              <li><b>-0.099 to 0.126</b>: Non-vegetated or very sparse cover (bare soil/water/dead).</li>
              <li><b>0.127 to 0.169</b>: Low-density vegetation; early growth or stressed plants.</li>
              <li><b>0.170 to 0.200</b>: Moderate vegetation health; healthy grass or sparse crops.</li>
              <li><b>0.201 to 0.236</b>: Denser vegetation; good photosynthetic activity.</li>
              <li><b>0.237 to 0.423</b>: Highest density; mature crops/dense healthy vegetation.</li>
            </ul>
          </div>
        </div>
        <div class="summary-card">
          <h3>Crop Health Assessment â€“ Summary</h3>
          <ul>
            <li><b>Healthy and well-watered crops (best fields)</b>: Green, well-hydrated areas with strong development; likely good yields if conditions persist.</li>
            <li><b>Healthy but dry crops</b>: Green fields showing early water limitation; need timely rain or irrigation to maintain vigor.</li>
            <li><b>Wet but weak crops</b>: Adequate moisture but poor growthâ€”possible waterlogging, pests, or disease; inspect on ground.</li>
            <li><b>Poor or bare areas</b>: Little/no vegetationâ€”fallow, late-planted, or highly stressed; yields likely low.</li>
          </ul>
          <p><b>Overall</b>: Conditions are fair to good with pockets of water stress and localized weak growth despite water. Maintain strong fields, supplement water where possible, and investigate weak or flooded zones.</p>
        </div>
        <div class="image-card">
          <h3>NDWI Map</h3>
          <p>Normalized Difference Water Index indicating water stress.</p>
          <div id="ndwiContainer">
            <img id="ndwiImage" src="https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDWI._NEW1png.png" alt="NDWI Map">
            <div id="ndwiControls" style="margin-top: 10px;">
              <button onclick="toggleNDWIView()" style="background: linear-gradient(90deg, #00d4ff, #7b00ff); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-size: 0.9em; font-weight: 500;">Next: 3D View</button>
            </div>
          </div>
          <p class="note">Static NDWI image from repository.</p>
          <div class="info-card">
            <h4>NDWI Interpretation (Range: -0.656 to 0.260)</h4>
            <ul>
              <li><b>-0.656 to -0.071</b>: Non-water surfaces (urban, bare soil) or very dry vegetation.</li>
              <li><b>-0.070 to -0.028</b>: Dry/sparse vegetation; limited water availability; mildâ€“moderate stress.</li>
              <li><b>-0.027 to 0.022</b>: Moderate vegetation water content; average soil moisture.</li>
              <li><b>0.023 to 0.087</b>: Healthier vegetation with higher water content; adequate moisture.</li>
              <li><b>0.088 to 0.260</b>: Highest water content; well-hydrated crops or local surface water.</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="compare-card">
        <h3 style="margin: 0 0 12px; color: #00d4ff;">Compare NDVI vs NDWI</h3>
        <div id="ba1" class="ba-container">
          <div class="ba-wrapper">
            <img class="ba-bottom" src="https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDWI._NEW1png.png" alt="NDWI Base">
            <div class="ba-top" style="width: 50%;">
              <img src="https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDVI_NEW.png" alt="NDVI Overlay">
            </div>
            <div class="ba-divider" style="left: 50%;"></div>
            <div class="ba-handle" style="left: 50%;"></div>
          </div>
        </div>
        <div class="ba-controls">
          <label for="baRange">Slide to compare</label>
          <input id="baRange" class="ba-range" type="range" min="0" max="100" value="50" oninput="updateBeforeAfter('ba1', this.value)">
        </div>
      </div>
      <div style="text-align: center;">
        <button class="back-button" onclick="backToAgriculture()">Back to Agriculture Solutions</button>
      </div>
    </div>
  </div>
  <!-- Fullscreen image modal -->
  <div id="imgModal" class="img-modal" onclick="onModalBackgroundClick(event)">
    <span class="close" onclick="closeModal()">Ã—</span>
    <img id="modalImg" src="" alt="Expanded view" />
  </div>

  <!-- AI Chatbot -->
  <div id="chatbot" class="chatbot-container">
    <div class="chatbot-header" onclick="toggleChatbot()">
      <h3>ðŸ¤– PF-GEOINT Assistant</h3>
      <button class="chatbot-toggle" id="chatbotToggle">âˆ’</button>
    </div>
    <div class="chatbot-messages" id="chatbotMessages">
      <div class="chatbot-message bot">
        ðŸ‘‹ Hello! I'm your PF-GEOINT assistant. I can help you find the right geospatial solutions for your needs. What can I help you with today?
      </div>
    </div>
    <div class="chatbot-typing" id="chatbotTyping">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <div class="chatbot-input-container">
      <input type="text" class="chatbot-input" id="chatbotInput" placeholder="Ask about our solutions..." onkeypress="handleChatbotKeypress(event)">
      <button class="chatbot-send" id="chatbotSend" onclick="sendChatbotMessage()">â†’</button>
    </div>
  </div>
  <script>
    function learnMore(sector) {
      if (sector === 'agriculture') {
        document.getElementById('main-products').style.display = 'none';
        const view = document.getElementById('agriculture-solutions');
        view.style.display = 'block';
        addEnterAnimation(view);
      } else if (sector === 'defense') {
        document.getElementById('main-products').style.display = 'none';
        const view = document.getElementById('defense-solutions');
        view.style.display = 'block';
        addEnterAnimation(view);
      } else {
        alert(`Explore PF-GEOINT solutions for ${sector}!`);
        // Replace with actual logic for other sectors
      }
    }

    function showCropHealth() {
      document.getElementById('agriculture-solutions').style.display = 'none';
      const view = document.getElementById('crop-health');
      view.style.display = 'block';
      addEnterAnimation(view);
      // enable click-to-zoom for images
      enableImageZoom('ndviImage');
      enableImageZoom('ndwiImage');
      // preload 3D images for faster switching
      preload3DImages();
    }

    function showGeoTrace() {
      document.getElementById('defense-solutions').style.display = 'none';
      const view = document.getElementById('geotrace');
      view.style.display = 'block';
      addEnterAnimation(view);
      // enable click-to-zoom for image
      enableImageZoom('geotraceImage');
    }

    function backToAgriculture() {
      document.getElementById('crop-health').style.display = 'none';
      const view = document.getElementById('agriculture-solutions');
      view.style.display = 'block';
      addEnterAnimation(view);
    }

    function backToDefense() {
      document.getElementById('geotrace').style.display = 'none';
      const view = document.getElementById('defense-solutions');
      view.style.display = 'block';
      addEnterAnimation(view);
    }

    function backToMain() {
      document.getElementById('agriculture-solutions').style.display = 'none';
      document.getElementById('defense-solutions').style.display = 'none';
      const view = document.getElementById('main-products');
      view.style.display = 'grid';
      addEnterAnimation(view);
    }

    // No additional rendering required; both NDVI and NDWI use static images.

    function enableImageZoom(imageId) {
      const img = document.getElementById(imageId);
      if (img && !img._zoomEnabled) {
        img.addEventListener('click', () => openModal(img.src));
        img._zoomEnabled = true;
      }
    }

    function openModal(src) {
      const modal = document.getElementById('imgModal');
      const modalImg = document.getElementById('modalImg');
      modalImg.src = src;
      modal.style.display = 'block';
      modalImg.style.animation = 'none';
      void modalImg.offsetWidth;
      modalImg.style.animation = '';
      document.addEventListener('keydown', onEscClose);
    }

    function closeModal() {
      const modal = document.getElementById('imgModal');
      modal.style.display = 'none';
      document.removeEventListener('keydown', onEscClose);
    }

    function onEscClose(e) {
      if (e.key === 'Escape') closeModal();
    }

    function onModalBackgroundClick(e) {
      if (e.target && e.target.id === 'imgModal') closeModal();
    }
    document.addEventListener('click', function(e) {
      const isBack = e.target.classList.contains('back-button');
      const isProductBtn = e.target.tagName === 'BUTTON' && e.target.closest('.product-card');
      const btn = isBack || isProductBtn ? e.target : null;
      if (!btn) return;
      const rect = btn.getBoundingClientRect();
      const circle = document.createElement('span');
      const diameter = Math.max(rect.width, rect.height);
      const radius = diameter / 2;
      circle.style.width = circle.style.height = `${diameter}px`;
      circle.style.left = `${e.clientX - rect.left - radius}px`;
      circle.style.top = `${e.clientY - rect.top - radius}px`;
      circle.classList.add('ripple');
      const oldRipple = btn.querySelector('.ripple');
      if (oldRipple) oldRipple.remove();
      btn.appendChild(circle);
    }, true);

    function addEnterAnimation(el) {
      el.style.animation = 'fadeInUp 380ms ease-out';
      setTimeout(() => { el.style.animation = ''; }, 400);
    }

    // Before-After slider logic
    function updateBeforeAfter(containerId, percent) {
      const container = document.getElementById(containerId);
      if (!container) return;
      const top = container.querySelector('.ba-top');
      const divider = container.querySelector('.ba-divider');
      const handle = container.querySelector('.ba-handle');
      const p = Math.max(0, Math.min(100, Number(percent)));
      top.style.width = p + '%';
      divider.style.left = p + '%';
      handle.style.left = p + '%';
    }

    // Preload 3D images for faster switching
    let ndvi3DLoaded = false;
    let ndwi3DLoaded = false;
    function preload3DImages() {
      if (!ndvi3DLoaded) {
        const ndvi3D = new Image();
        ndvi3D.src = 'https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDVI_1D3D.png';
        ndvi3D.onload = () => { ndvi3DLoaded = true; };
      }
      if (!ndwi3DLoaded) {
        const ndwi3D = new Image();
        ndwi3D.src = 'https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDWI_3DV.png';
        ndwi3D.onload = () => { ndwi3DLoaded = true; };
      }
    }

    // NDVI view toggle (2D <-> 3D)
    let ndviView3D = false;
    function toggleNDVIView() {
      const img = document.getElementById('ndviImage');
      const btn = document.querySelector('#ndviControls button');
      
      // Show loading state
      btn.textContent = 'Loading...';
      btn.disabled = true;
      
      if (ndviView3D) {
        // Switch to 2D
        img.src = 'https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDVI_NEW.png';
        img.alt = 'NDVI Map';
        btn.textContent = 'Next: 3D View';
        ndviView3D = false;
        btn.disabled = false;
      } else {
        // Switch to 3D
        img.src = 'https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDVI_1D3D.png';
        img.alt = 'NDVI 3D Visualization';
        
        img.onload = () => {
          btn.textContent = 'Back: 2D View';
          btn.disabled = false;
        };
        
        img.onerror = () => {
          btn.textContent = 'Next: 3D View';
          btn.disabled = false;
          alert('Failed to load 3D visualization');
        };
        
        ndviView3D = true;
      }
    }

    // NDWI view toggle (2D <-> 3D)
    let ndwiView3D = false;
    function toggleNDWIView() {
      const img = document.getElementById('ndwiImage');
      const btn = document.querySelector('#ndwiControls button');
      
      // Show loading state
      btn.textContent = 'Loading...';
      btn.disabled = true;
      
      if (ndwiView3D) {
        // Switch to 2D
        img.src = 'https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDWI._NEW1png.png';
        img.alt = 'NDWI Map';
        btn.textContent = 'Next: 3D View';
        ndwiView3D = false;
        btn.disabled = false;
      } else {
        // Switch to 3D
        img.src = 'https://raw.githubusercontent.com/PFG-Sanusi/GEOINT/main/NDWI_3DV.png';
        img.alt = 'NDWI 3D Visualization';
        
        img.onload = () => {
          btn.textContent = 'Back: 2D View';
          btn.disabled = false;
        };
        
        img.onerror = () => {
          btn.textContent = 'Next: 3D View';
          btn.disabled = false;
          alert('Failed to load 3D visualization');
        };
        
        ndwiView3D = true;
      }
    }

    // AI Chatbot functionality
    let chatbotOpen = false;
    const products = {
      'agriculture': {
        name: 'Agriculture',
        description: 'Boost yields with precision farming, soil analysis, and real-time weather monitoring for smarter agriculture.',
        keywords: ['crop', 'farm', 'agriculture', 'yield', 'soil', 'weather', 'irrigation', 'vegetation', 'ndvi', 'ndwi', 'dying', 'stress', 'health']
      },
      'defense': {
        name: 'Defense & Security',
        description: 'Advanced surveillance, threat detection, and mission planning with high-resolution imagery and AI-powered insights.',
        keywords: ['defense', 'security', 'surveillance', 'threat', 'mission', 'military', 'monitoring', 'intelligence']
      },
      'urban-planning': {
        name: 'Urban Planning',
        description: 'Design future-ready cities with 3D mapping, infrastructure monitoring, and population analytics.',
        keywords: ['urban', 'city', 'planning', 'infrastructure', 'population', 'development', 'mapping', '3d']
      },
      'environment': {
        name: 'Environmental Monitoring',
        description: 'Track climate change, deforestation, and resources with cutting-edge GEOINT analytics.',
        keywords: ['environment', 'climate', 'deforestation', 'resources', 'conservation', 'monitoring', 'change']
      },
      'transportation': {
        name: 'Transportation & Logistics',
        description: 'Optimize routes and enhance logistics with real-time traffic analysis and geospatial data.',
        keywords: ['transportation', 'logistics', 'traffic', 'routes', 'shipping', 'delivery', 'optimization']
      },
      'energy': {
        name: 'Energy & Utilities',
        description: 'Monitor pipelines, renewable energy sites, and grid performance with precision geospatial tools.',
        keywords: ['energy', 'utilities', 'pipeline', 'renewable', 'grid', 'power', 'electricity', 'oil', 'gas']
      }
    };

    function toggleChatbot() {
      const chatbot = document.getElementById('chatbot');
      const toggle = document.getElementById('chatbotToggle');
      
      chatbotOpen = !chatbotOpen;
      chatbot.classList.toggle('open', chatbotOpen);
      toggle.textContent = chatbotOpen ? 'âˆ’' : '+';
    }

    function handleChatbotKeypress(event) {
      if (event.key === 'Enter') {
        sendChatbotMessage();
      }
    }

    function sendChatbotMessage() {
      const input = document.getElementById('chatbotInput');
      const message = input.value.trim();
      
      if (!message) return;
      
      // Add user message
      addChatbotMessage(message, 'user');
      input.value = '';
      
      // Show typing indicator
      showTypingIndicator();
      
      // Process message after short delay
      setTimeout(() => {
        hideTypingIndicator();
        const response = processChatbotMessage(message);
        addChatbotMessage(response, 'bot');
      }, 800 + Math.random() * 400); // Random delay for natural feel
    }

    function addChatbotMessage(text, sender) {
      const messagesContainer = document.getElementById('chatbotMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = `chatbot-message ${sender}`;
      messageDiv.textContent = text;
      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function showTypingIndicator() {
      document.getElementById('chatbotTyping').style.display = 'flex';
      document.getElementById('chatbotMessages').scrollTop = document.getElementById('chatbotMessages').scrollHeight;
    }

    function hideTypingIndicator() {
      document.getElementById('chatbotTyping').style.display = 'none';
    }

    // Company information
    const companyInfo = {
      boss: "Engr Tope Robert, Head of Proforce Galaxies Limited",
      creator: "Proforce Galaxies Limited",
      ceo: "Engr Ade Ogundeyin",
      company: "Proforce Galaxies Limited"
    };

    // Advanced conversation context and memory
    let conversationContext = {
      currentTopic: null,
      userIndustry: null,
      userNeeds: [],
      previousQuestions: [],
      sessionStart: new Date(),
      userProfile: {
        name: null,
        company: null,
        role: null,
        experience: null,
        budget: null,
        timeline: null,
        preferences: []
      },
      conversationFlow: [],
      emotionalState: 'neutral',
      intent: null,
      entities: [],
      confidence: 0,
      followUpNeeded: false
    };

    // Advanced NLP patterns and intent recognition
    const intentPatterns = {
      greeting: ['hi', 'hello', 'hey', 'good morning', 'good afternoon', 'good evening'],
      inquiry: ['what', 'how', 'when', 'where', 'why', 'can you', 'do you', 'is it possible'],
      problem: ['problem', 'issue', 'challenge', 'struggling', 'difficulty', 'trouble', 'help'],
      comparison: ['compare', 'difference', 'better', 'best', 'versus', 'vs', 'which'],
      pricing: ['price', 'cost', 'budget', 'expensive', 'cheap', 'affordable', 'quote'],
      timeline: ['when', 'how long', 'timeline', 'schedule', 'deadline', 'urgent'],
      technical: ['technical', 'specs', 'specifications', 'features', 'capabilities', 'integration'],
      contact: ['contact', 'speak', 'meeting', 'call', 'email', 'representative', 'sales']
    };

    // Emotional intelligence patterns
    const emotionalPatterns = {
      frustrated: ['frustrated', 'annoyed', 'angry', 'upset', 'disappointed', 'fed up'],
      excited: ['excited', 'thrilled', 'amazing', 'fantastic', 'great', 'wonderful'],
      confused: ['confused', 'unclear', 'don\'t understand', 'lost', 'unclear'],
      urgent: ['urgent', 'asap', 'immediately', 'quickly', 'emergency', 'critical'],
      skeptical: ['skeptical', 'doubt', 'not sure', 'hesitant', 'concerned', 'worried']
    };

    // Advanced entity extraction
    function extractEntities(message) {
      const entities = [];
      const lowerMessage = message.toLowerCase();
      
      // Industry entities
      const industries = ['agriculture', 'farming', 'defense', 'military', 'security', 'urban', 'city', 'environment', 'transportation', 'logistics', 'energy', 'utilities'];
      industries.forEach(industry => {
        if (lowerMessage.includes(industry)) entities.push({type: 'industry', value: industry});
      });
      
      // Technology entities
      const technologies = ['satellite', 'gps', 'ai', 'machine learning', 'ndvi', 'ndwi', 'geotrace', 'drone', 'sensor'];
      technologies.forEach(tech => {
        if (lowerMessage.includes(tech)) entities.push({type: 'technology', value: tech});
      });
      
      // Scale entities
      const scales = ['small', 'medium', 'large', 'enterprise', 'startup', 'corporation', 'government'];
      scales.forEach(scale => {
        if (lowerMessage.includes(scale)) entities.push({type: 'scale', value: scale});
      });
      
      // Location entities (basic)
      const locations = ['nigeria', 'africa', 'europe', 'america', 'asia', 'local', 'global', 'regional'];
      locations.forEach(location => {
        if (lowerMessage.includes(location)) entities.push({type: 'location', value: location});
      });
      
      return entities;
    }

    // Intent recognition
    function recognizeIntent(message) {
      const lowerMessage = message.toLowerCase();
      let maxScore = 0;
      let detectedIntent = 'general';
      
      for (const [intent, patterns] of Object.entries(intentPatterns)) {
        let score = 0;
        patterns.forEach(pattern => {
          if (lowerMessage.includes(pattern)) score++;
        });
        if (score > maxScore) {
          maxScore = score;
          detectedIntent = intent;
        }
      }
      
      return detectedIntent;
    }

    // Emotional state detection
    function detectEmotionalState(message) {
      const lowerMessage = message.toLowerCase();
      
      for (const [emotion, patterns] of Object.entries(emotionalPatterns)) {
        if (patterns.some(pattern => lowerMessage.includes(pattern))) {
          return emotion;
        }
      }
      
      return 'neutral';
    }

    // Advanced response generation
    function generateContextualResponse(intent, emotion, entities, confidence) {
      const responses = {
        greeting: {
          excited: "Hello! ðŸš€ I'm thrilled to meet you! I'm your advanced AI assistant from Proforce Galaxies Limited, and I'm excited to help you discover the perfect geospatial intelligence solutions. What amazing project are you working on?",
          neutral: "Hello! ðŸ‘‹ I'm your PF-GEOINT AI assistant from Proforce Galaxies Limited. I specialize in geospatial intelligence solutions and can help you find the perfect technology for your specific needs. What challenges are you facing?",
          frustrated: "Hello! I understand you might be feeling frustrated, and I'm here to help make this process as smooth as possible. I'm your PF-GEOINT AI assistant, and I'll do my best to provide clear, helpful solutions. What can I assist you with today?"
        },
        inquiry: {
          excited: "Great question! ðŸŽ¯ I love your curiosity! Let me provide you with comprehensive information about our solutions. Based on what I'm hearing, you're really engaged with finding the right technology.",
          neutral: "Excellent question! Let me provide you with detailed information about our solutions and how they can address your specific needs.",
          confused: "I understand this might be confusing, and I'm here to clarify everything for you. Let me break this down in simple terms and provide clear explanations."
        }
      };
      
      return responses[intent]?.[emotion] || responses[intent]?.neutral || "I'm here to help! Let me provide you with the information you need.";
    }

    // Calculate confidence score
    function calculateConfidence(message, entities) {
      let confidence = 0;
      const lowerMessage = message.toLowerCase();
      
      // Base confidence from entities
      confidence += entities.length * 0.2;
      
      // Confidence from keyword density
      const totalWords = message.split(' ').length;
      const relevantKeywords = ['agriculture', 'defense', 'security', 'urban', 'environment', 'transportation', 'energy', 'satellite', 'gps', 'ndvi', 'ndwi'];
      const keywordCount = relevantKeywords.filter(keyword => lowerMessage.includes(keyword)).length;
      confidence += (keywordCount / totalWords) * 0.5;
      
      // Confidence from question clarity
      if (lowerMessage.includes('what') || lowerMessage.includes('how') || lowerMessage.includes('can you')) {
        confidence += 0.2;
      }
      
      return Math.min(confidence, 1.0);
    }

    // Extract user profile information
    function extractUserProfile(message, entities) {
      const lowerMessage = message.toLowerCase();
      
      // Extract company name
      if (lowerMessage.includes('i work') || lowerMessage.includes('my company') || lowerMessage.includes('we are')) {
        const companyMatch = message.match(/(?:i work (?:at|for)|my company|we are) ([^,.\n]+)/i);
        if (companyMatch) {
          conversationContext.userProfile.company = companyMatch[1].trim();
        }
      }
      
      // Extract role
      const roles = ['manager', 'director', 'engineer', 'analyst', 'consultant', 'ceo', 'cto', 'farmer', 'planner'];
      roles.forEach(role => {
        if (lowerMessage.includes(`i am a ${role}`) || lowerMessage.includes(`i'm a ${role}`)) {
          conversationContext.userProfile.role = role;
        }
      });
      
      // Extract experience level
      if (lowerMessage.includes('beginner') || lowerMessage.includes('new to')) {
        conversationContext.userProfile.experience = 'beginner';
      } else if (lowerMessage.includes('experienced') || lowerMessage.includes('expert')) {
        conversationContext.userProfile.experience = 'expert';
      } else if (lowerMessage.includes('intermediate') || lowerMessage.includes('some experience')) {
        conversationContext.userProfile.experience = 'intermediate';
      }
      
      // Extract budget information
      if (lowerMessage.includes('budget') || lowerMessage.includes('cost')) {
        const budgetMatch = message.match(/(\d+)(?:k|thousand|million|m)/i);
        if (budgetMatch) {
          conversationContext.userProfile.budget = budgetMatch[0];
        }
      }
      
      // Extract timeline
      if (lowerMessage.includes('urgent') || lowerMessage.includes('asap')) {
        conversationContext.userProfile.timeline = 'urgent';
      } else if (lowerMessage.includes('month') || lowerMessage.includes('quarter')) {
        conversationContext.userProfile.timeline = 'short-term';
      } else if (lowerMessage.includes('year') || lowerMessage.includes('long-term')) {
        conversationContext.userProfile.timeline = 'long-term';
      }
      
      // Update industry from entities
      const industryEntity = entities.find(e => e.type === 'industry');
      if (industryEntity) {
        conversationContext.userProfile.preferences.push(industryEntity.value);
      }
    }

    // Generate predictive follow-up questions
    function generatePredictiveQuestions(context) {
      const questions = [];
      
      if (context.userProfile.experience === 'beginner') {
        questions.push("Would you like me to explain the technical aspects in simpler terms?");
      }
      
      if (context.userProfile.timeline === 'urgent') {
        questions.push("Since this is urgent, would you like me to connect you directly with our technical team?");
      }
      
      if (context.userProfile.budget) {
        questions.push(`Given your budget of ${context.userProfile.budget}, would you like me to recommend the most cost-effective solution?`);
      }
      
      if (context.userProfile.company) {
        questions.push(`How can we tailor our solutions specifically for ${context.userProfile.company}?`);
      }
      
      return questions;
    }

    // Advanced solution recommendation with context
    function generateAdvancedRecommendation(bestMatch, context, entities) {
      let recommendation = `ðŸŽ¯ **Intelligent Analysis Complete**\n\n`;
      
      // Confidence level with explanation
      const confidenceLevel = context.confidence > 0.8 ? 'extremely confident' : 
                             context.confidence > 0.6 ? 'highly confident' : 
                             context.confidence > 0.4 ? 'confident' : 'somewhat confident';
      
      recommendation += `I'm ${confidenceLevel} that our **${bestMatch.name}** solution is perfect for your needs.\n\n`;
      
      // Context-aware explanation
      if (context.userProfile.experience === 'beginner') {
        recommendation += `**Perfect for Beginners:** This solution is designed to be user-friendly while providing powerful capabilities.\n\n`;
      } else if (context.userProfile.experience === 'expert') {
        recommendation += `**Advanced Capabilities:** This solution offers the sophisticated features and customization options you need.\n\n`;
      }
      
      // Industry-specific benefits
      const industryEntity = entities.find(e => e.type === 'industry');
      if (industryEntity) {
        recommendation += `**${industryEntity.value.charAt(0).toUpperCase() + industryEntity.value.slice(1)} Focus:** This solution is specifically optimized for ${industryEntity.value} applications.\n\n`;
      }
      
      // Timeline considerations
      if (context.userProfile.timeline === 'urgent') {
        recommendation += `**Rapid Deployment:** We can have this solution implemented quickly to meet your urgent timeline.\n\n`;
      }
      
      // Budget considerations
      if (context.userProfile.budget) {
        recommendation += `**Budget Optimized:** This solution provides excellent value within your budget of ${context.userProfile.budget}.\n\n`;
      }
      
      recommendation += `**Why This Solution Fits:**\n${bestMatch.description}\n\n`;
      
      // Predictive questions
      const predictiveQuestions = generatePredictiveQuestions(context);
      if (predictiveQuestions.length > 0) {
        recommendation += `**Next Steps:**\n`;
        predictiveQuestions.forEach(q => recommendation += `â€¢ ${q}\n`);
        recommendation += `\n`;
      }
      
      recommendation += `**Proforce Galaxies Limited Support:**\nâ€¢ 24/7 technical support\nâ€¢ Custom implementation guidance\nâ€¢ Training and onboarding\nâ€¢ Ongoing optimization\n\nWhat would you like to explore next?`;
      
      return recommendation;
    }

    function processChatbotMessage(message) {
      const lowerMessage = message.toLowerCase();
      
      // Advanced AI Processing Pipeline
      const intent = recognizeIntent(message);
      const emotion = detectEmotionalState(message);
      const entities = extractEntities(message);
      const confidence = calculateConfidence(message, entities);
      
      // Update conversation context
      conversationContext.intent = intent;
      conversationContext.emotionalState = emotion;
      conversationContext.entities = entities;
      conversationContext.confidence = confidence;
      conversationContext.previousQuestions.push(message);
      conversationContext.conversationFlow.push({
        timestamp: new Date(),
        message: message,
        intent: intent,
        emotion: emotion,
        entities: entities
      });
      
      // Extract user profile information
      extractUserProfile(message, entities);
      
      // Company information queries with emotional intelligence
      if (lowerMessage.includes('boss') || lowerMessage.includes('who is your boss')) {
        const emotionalResponse = emotion === 'excited' ? "I'm excited to tell you!" : 
                                 emotion === 'frustrated' ? "I'm happy to clarify this for you." : "";
        return `${emotionalResponse} ðŸ‘” My boss is **${companyInfo.boss}**. He leads our team in developing cutting-edge geospatial intelligence solutions and has been instrumental in our company's growth.`;
      }
      
      if (lowerMessage.includes('created') || lowerMessage.includes('who created you') || lowerMessage.includes('who made you')) {
        return `ðŸ¢ I was created by **${companyInfo.creator}**, a leading company in geospatial intelligence and satellite technology solutions. Our team of expert engineers and data scientists developed me to provide intelligent assistance in geospatial solutions.`;
      }
      
      if (lowerMessage.includes('ceo') || lowerMessage.includes('gmd') || lowerMessage.includes('md') || lowerMessage.includes('managing director')) {
        return `ðŸ‘¨â€ðŸ’¼ Our CEO/GMD/MD is **${companyInfo.ceo}**. He leads Proforce Galaxies Limited in delivering innovative geospatial solutions worldwide and has extensive experience in satellite technology and geospatial intelligence.`;
      }
      
      if (lowerMessage.includes('proforce') || lowerMessage.includes('company') || lowerMessage.includes('about proforce')) {
        const companyResponse = `ðŸ¢ **Proforce Galaxies Limited** is a leading geospatial intelligence company specializing in:\n\nâ€¢ Advanced satellite imagery analysis\nâ€¢ AI-powered geospatial solutions\nâ€¢ Defense and security applications\nâ€¢ Agricultural monitoring systems\nâ€¢ Urban planning and infrastructure development\n\n**Our Expertise:**\nâ€¢ Over 10 years of experience in geospatial intelligence\nâ€¢ Advanced AI and machine learning algorithms\nâ€¢ Real-time satellite data processing capabilities\nâ€¢ Custom solutions for unique requirements\nâ€¢ 24/7 technical support and consultation\n\nWe're committed to transforming how organizations use geospatial data for decision-making.`;
        
        if (conversationContext.userProfile.company) {
          return `${companyResponse}\n\nI'd love to learn more about ${conversationContext.userProfile.company} and how we can help your organization!`;
        }
        return companyResponse;
      }
      
      // Enhanced greeting responses with context awareness
      if (lowerMessage.includes('hi') || lowerMessage.includes('hello') || lowerMessage.includes('hey')) {
        conversationContext.currentTopic = 'greeting';
        const greetings = [
          "Hello! ðŸ‘‹ I'm your PF-GEOINT AI assistant from Proforce Galaxies Limited. I specialize in geospatial intelligence solutions and can help you find the perfect technology for your specific needs. What challenges are you facing?",
          "Hi there! ðŸ¤– I'm here to analyze your requirements and recommend the most suitable PF-GEOINT solutions. Tell me about your project or challenges.",
          "Greetings! ðŸš€ I'm an advanced AI trained on geospatial intelligence by Proforce Galaxies Limited. I can help you navigate our solutions and find exactly what you need. What's your use case?"
        ];
        return greetings[Math.floor(Math.random() * greetings.length)];
      }
      
      // Advanced keyword analysis with weighted scoring
      const keywordWeights = {
        'agriculture': {
          'crop': 3, 'farm': 3, 'agriculture': 3, 'yield': 2, 'soil': 2, 'weather': 2, 
          'irrigation': 3, 'vegetation': 2, 'ndvi': 4, 'ndwi': 4, 'dying': 3, 'stress': 2, 
          'health': 2, 'disease': 2, 'pest': 2, 'fertilizer': 2, 'harvest': 2, 'field': 2,
          'precision': 2, 'monitoring': 2, 'analysis': 2, 'water': 2, 'moisture': 2
        },
        'defense': {
          'defense': 3, 'security': 3, 'surveillance': 3, 'threat': 3, 'mission': 2, 'military': 3,
          'monitoring': 2, 'intelligence': 2, 'tactical': 3, 'geotrace': 4, 'gps': 2, 'tracking': 2,
          'border': 2, 'protection': 2, 'operation': 2, 'strategic': 2, 'buffer': 2, 'zone': 2
        },
        'urban-planning': {
          'urban': 3, 'city': 3, 'planning': 3, 'infrastructure': 3, 'population': 2, 'development': 2,
          'mapping': 2, '3d': 2, 'smart': 2, 'municipal': 2, 'government': 2, 'construction': 2
        },
        'environment': {
          'environment': 3, 'climate': 3, 'deforestation': 3, 'resources': 2, 'conservation': 2,
          'monitoring': 2, 'change': 2, 'carbon': 2, 'emission': 2, 'sustainability': 2, 'green': 2
        },
        'transportation': {
          'transportation': 3, 'logistics': 3, 'traffic': 3, 'routes': 2, 'shipping': 2, 'delivery': 2,
          'optimization': 2, 'fleet': 2, 'supply': 2, 'chain': 2, 'distribution': 2, 'warehouse': 2,
          'road': 4, 'highway': 3, 'street': 3, 'infrastructure': 3, 'pavement': 2, 'bridge': 2,
          'tunnel': 2, 'intersection': 2, 'congestion': 3, 'maintenance': 2, 'construction': 2,
          'asphalt': 2, 'pothole': 3, 'repair': 2, 'safety': 2, 'accident': 2, 'vehicle': 2
        },
        'energy': {
          'energy': 3, 'utilities': 3, 'pipeline': 3, 'renewable': 2, 'grid': 2, 'power': 2,
          'electricity': 2, 'oil': 2, 'gas': 2, 'solar': 2, 'wind': 2, 'infrastructure': 2
        }
      };
      
      // Calculate weighted scores for each product
      let bestMatch = null;
      let maxScore = 0;
      
      for (const [key, weights] of Object.entries(keywordWeights)) {
        let score = 0;
        for (const [keyword, weight] of Object.entries(weights)) {
          if (lowerMessage.includes(keyword)) {
            score += weight;
          }
        }
        if (score > maxScore) {
          maxScore = score;
          bestMatch = { key, ...products[key] };
        }
      }
      
      // Update conversation context
      conversationContext.previousQuestions.push(message);
      
      // Context-aware responses with follow-up questions
      if (lowerMessage.includes('crop') && (lowerMessage.includes('dying') || lowerMessage.includes('problem') || lowerMessage.includes('issue') || lowerMessage.includes('sick'))) {
        conversationContext.currentTopic = 'agriculture';
        conversationContext.userIndustry = 'agriculture';
        conversationContext.userNeeds.push('crop_health');
        
        return "ðŸŒ± I understand you're experiencing crop health issues! This is exactly what our Agriculture solution excels at. Here's how we can help:\n\n**Immediate Analysis:**\nâ€¢ NDVI (Normalized Difference Vegetation Index) to assess plant health\nâ€¢ NDWI (Normalized Difference Water Index) to detect water stress\nâ€¢ Real-time monitoring of vegetation stress patterns\n\n**Actionable Solutions:**\nâ€¢ Precision farming recommendations based on data analysis\nâ€¢ Weather-based irrigation guidance\nâ€¢ Disease and pest detection algorithms\nâ€¢ Soil health assessment\n\n**Questions to help me assist better:**\nâ€¢ What type of crops are you growing?\nâ€¢ Are you seeing specific symptoms (yellowing, wilting, spots)?\nâ€¢ What's your current irrigation setup?\nâ€¢ What's the size of your farming operation?\n\nWould you like me to dive deeper into any of these aspects? I can also connect you with our agricultural specialists at Proforce Galaxies Limited.";
      }
      
      if (lowerMessage.includes('water') || lowerMessage.includes('irrigation') || lowerMessage.includes('moisture') || lowerMessage.includes('drought')) {
        return "ðŸ’§ Water management is critical for agricultural success! Our Agriculture solution provides comprehensive water optimization:\n\n**Advanced Water Analysis:**\nâ€¢ NDWI analysis for precise water stress detection\nâ€¢ Soil moisture monitoring across your entire field\nâ€¢ Evapotranspiration calculations\nâ€¢ Water usage efficiency metrics\n\n**Smart Irrigation Features:**\nâ€¢ Automated irrigation scheduling based on weather data\nâ€¢ Zone-specific watering recommendations\nâ€¢ Leak detection and water loss prevention\nâ€¢ Integration with existing irrigation systems\n\n**ROI Benefits:**\nâ€¢ Reduce water usage by 20-30%\nâ€¢ Prevent over/under-watering damage\nâ€¢ Optimize crop yields through precise water management\n\nAre you currently using any irrigation technology, or are you looking to implement a new system?";
      }
      
      if (lowerMessage.includes('security') || lowerMessage.includes('surveillance') || lowerMessage.includes('threat') || lowerMessage.includes('defense') || lowerMessage.includes('military')) {
        return "ðŸ›¡ï¸ Security and defense operations require the most advanced geospatial intelligence! Our Defense & Security solutions provide:\n\n**PF-GEOTRACE Platform:**\nâ€¢ Real-time GPS precision with sub-meter accuracy\nâ€¢ Dynamic marker systems for tactical operations\nâ€¢ Strategic buffer zones for security perimeters\nâ€¢ Satellite imagery integration for comprehensive situational awareness\n\n**Advanced Capabilities:**\nâ€¢ AI-powered threat detection and analysis\nâ€¢ High-resolution surveillance with real-time updates\nâ€¢ Mission planning with 3D terrain mapping\nâ€¢ Rapid data export for intelligence reports\nâ€¢ Multi-layer mapping for different operational scenarios\n\n**Applications:**\nâ€¢ Military operations and tactical planning\nâ€¢ Border security and surveillance\nâ€¢ Critical infrastructure protection\nâ€¢ Emergency response coordination\nâ€¢ Counter-terrorism operations\n\nWhat type of security operations are you planning? Are you looking for real-time monitoring, threat assessment, or mission planning capabilities?";
      }
      
      if (lowerMessage.includes('city') || lowerMessage.includes('urban') || lowerMessage.includes('planning') || lowerMessage.includes('infrastructure')) {
        return "ðŸ™ï¸ Urban planning requires sophisticated geospatial analysis! Our Urban Planning solution offers:\n\n**Comprehensive City Mapping:**\nâ€¢ High-resolution 3D city models\nâ€¢ Infrastructure monitoring and assessment\nâ€¢ Population density and growth analytics\nâ€¢ Traffic flow and transportation optimization\n\n**Smart City Development:**\nâ€¢ Real-time infrastructure health monitoring\nâ€¢ Predictive maintenance for city assets\nâ€¢ Environmental impact assessment\nâ€¢ Zoning and land use optimization\n\n**Data-Driven Insights:**\nâ€¢ Demographic analysis and population trends\nâ€¢ Economic development planning\nâ€¢ Public service optimization\nâ€¢ Emergency response planning\n\nAre you working on a specific urban development project? What's the scale - neighborhood, district, or city-wide planning?";
      }
      
      if (lowerMessage.includes('climate') || lowerMessage.includes('environment') || lowerMessage.includes('deforestation') || lowerMessage.includes('conservation')) {
        return "ðŸŒ Environmental monitoring is crucial for our planet's future! Our Environmental Monitoring solution provides:\n\n**Climate Change Tracking:**\nâ€¢ Carbon footprint monitoring and analysis\nâ€¢ Deforestation detection and tracking\nâ€¢ Temperature and precipitation pattern analysis\nâ€¢ Sea level rise and coastal erosion monitoring\n\n**Conservation Management:**\nâ€¢ Wildlife habitat mapping and protection\nâ€¢ Biodiversity assessment and monitoring\nâ€¢ Natural resource management\nâ€¢ Environmental impact assessment\n\n**Sustainability Analytics:**\nâ€¢ Renewable energy site assessment\nâ€¢ Water resource management\nâ€¢ Air quality monitoring\nâ€¢ Ecosystem health indicators\n\nWhat environmental challenges are you addressing? Are you focused on climate monitoring, conservation efforts, or sustainability initiatives?";
      }
      
      if (lowerMessage.includes('road') || lowerMessage.includes('highway') || lowerMessage.includes('street') || lowerMessage.includes('pothole') || lowerMessage.includes('congestion') || lowerMessage.includes('traffic')) {
        return "ðŸ›£ï¸ Road infrastructure issues are exactly what our Transportation & Logistics solution addresses! Here's how we can help:\n\n**Road Infrastructure Monitoring:**\nâ€¢ Real-time road condition assessment using satellite imagery\nâ€¢ Pothole detection and severity analysis\nâ€¢ Traffic congestion pattern analysis\nâ€¢ Bridge and tunnel structural monitoring\n\n**Smart Traffic Management:**\nâ€¢ AI-powered traffic flow optimization\nâ€¢ Accident hotspot identification and prevention\nâ€¢ Dynamic route planning to reduce congestion\nâ€¢ Real-time traffic incident detection\n\n**Infrastructure Planning:**\nâ€¢ Road maintenance scheduling based on usage patterns\nâ€¢ Construction impact assessment\nâ€¢ Alternative route planning during maintenance\nâ€¢ Safety analysis and risk assessment\n\n**What specific road issues are you facing?**\nâ€¢ Are you dealing with potholes, congestion, or safety concerns?\nâ€¢ Is this for city roads, highways, or rural infrastructure?\nâ€¢ Are you looking for monitoring, planning, or maintenance solutions?\n\nI can provide more targeted recommendations based on your specific needs!";
      }
      
      if (lowerMessage.includes('transport') || lowerMessage.includes('logistics') || lowerMessage.includes('shipping')) {
        return "ðŸš› Transportation and logistics optimization can significantly improve efficiency! Our Transportation & Logistics solution provides:\n\n**Route Optimization:**\nâ€¢ AI-powered route planning with real-time traffic data\nâ€¢ Multi-modal transportation analysis\nâ€¢ Fuel efficiency optimization\nâ€¢ Delivery time prediction and optimization\n\n**Supply Chain Intelligence:**\nâ€¢ End-to-end supply chain monitoring\nâ€¢ Warehouse location optimization\nâ€¢ Inventory management with geospatial insights\nâ€¢ Risk assessment for transportation routes\n\n**Fleet Management:**\nâ€¢ Real-time vehicle tracking and monitoring\nâ€¢ Maintenance scheduling based on usage patterns\nâ€¢ Driver behavior analysis\nâ€¢ Cost optimization across operations\n\nWhat's your transportation challenge? Are you optimizing delivery routes, managing a fleet, or planning supply chain logistics?";
      }
      
      if (lowerMessage.includes('energy') || lowerMessage.includes('power') || lowerMessage.includes('utility') || lowerMessage.includes('grid')) {
        return "âš¡ Energy infrastructure requires precise monitoring and management! Our Energy & Utilities solution offers:\n\n**Infrastructure Monitoring:**\nâ€¢ Pipeline integrity monitoring and leak detection\nâ€¢ Power grid performance analysis\nâ€¢ Substation and transmission line monitoring\nâ€¢ Renewable energy site assessment\n\n**Smart Grid Management:**\nâ€¢ Real-time power distribution optimization\nâ€¢ Demand forecasting and load balancing\nâ€¢ Outage prediction and prevention\nâ€¢ Energy efficiency optimization\n\n**Renewable Energy:**\nâ€¢ Solar and wind farm site selection\nâ€¢ Energy production forecasting\nâ€¢ Grid integration planning\nâ€¢ Environmental impact assessment\n\nAre you managing traditional energy infrastructure, renewable energy projects, or smart grid implementation?";
      }
      
      // Context-aware follow-up responses
      if (conversationContext.currentTopic === 'agriculture' && (lowerMessage.includes('yes') || lowerMessage.includes('sure') || lowerMessage.includes('tell me more'))) {
        return "ðŸŒ± Excellent! Let me provide more detailed information about our Agriculture solutions:\n\n**Our Agriculture Package Includes:**\nâ€¢ **Crop Health Assessment**: NDVI/NDWI analysis with 3D visualization\nâ€¢ **Precision Farming**: Zone-specific recommendations for fertilizers, pesticides\nâ€¢ **Weather Integration**: Real-time weather data for optimal farming decisions\nâ€¢ **Yield Prediction**: AI-powered crop yield forecasting\nâ€¢ **Cost Analysis**: ROI calculations and cost optimization\n\n**Implementation Process:**\n1. **Assessment**: We analyze your current farming setup\n2. **Data Collection**: Satellite imagery and ground truth data\n3. **Analysis**: AI-powered insights and recommendations\n4. **Implementation**: Step-by-step guidance for adoption\n5. **Monitoring**: Continuous support and optimization\n\n**Success Stories:**\nOur clients have seen:\nâ€¢ 25-40% increase in crop yields\nâ€¢ 30% reduction in water usage\nâ€¢ 20% decrease in fertilizer costs\nâ€¢ 50% reduction in crop losses\n\nWould you like to schedule a consultation with our agricultural specialists at Proforce Galaxies Limited?";
      }
      
      // Peak Intelligence: Advanced solution recommendation
      if (bestMatch && maxScore > 0) {
        conversationContext.currentTopic = bestMatch.key;
        conversationContext.userNeeds.push(bestMatch.key);
        
        return generateAdvancedRecommendation(bestMatch, conversationContext, entities);
      }
      
      // Context-aware default response
      if (conversationContext.previousQuestions.length > 0) {
        return `ðŸ¤” I want to make sure I understand your needs completely. ${conversationContext.currentTopic ? `I see we've been discussing ${conversationContext.currentTopic} solutions. ` : ''}Could you provide more specific details about:\n\n**Your Situation:**\nâ€¢ What industry or sector are you in?\nâ€¢ What specific challenges are you trying to solve?\nâ€¢ What's the scale of your operation?\nâ€¢ What's your current technology setup?\n\n**Your Goals:**\nâ€¢ Are you looking for real-time monitoring, analysis, or planning tools?\nâ€¢ What's your timeline for implementation?\nâ€¢ What's your budget range?\nâ€¢ Do you need training and support?\n\n**Proforce Galaxies Limited Solutions:**\nðŸŒ± **Agriculture** - Crop health, precision farming, irrigation\nðŸ›¡ï¸ **Defense & Security** - Tactical operations, surveillance, PF-GEOTRACE\nðŸ™ï¸ **Urban Planning** - Smart city development, infrastructure\nðŸŒ **Environmental** - Climate tracking, conservation\nðŸš› **Transportation** - Logistics optimization, fleet management\nâš¡ **Energy & Utilities** - Grid monitoring, renewable energy\n\nThe more details you provide, the better I can assist you with the perfect solution!`;
      }
      
      // Enhanced default response with intelligent suggestions
      return "ðŸ¤” I'd be happy to help you find the perfect solution! PF-GEOINT by Proforce Galaxies Limited offers advanced geospatial intelligence across multiple sectors:\n\n**ðŸŒ± Agriculture** - Crop health monitoring, precision farming, irrigation optimization\n**ðŸ›¡ï¸ Defense & Security** - Tactical operations, surveillance, threat detection, PF-GEOTRACE\n**ðŸ™ï¸ Urban Planning** - Smart city development, infrastructure monitoring\n**ðŸŒ Environmental** - Climate tracking, conservation, sustainability\n**ðŸš› Transportation** - Logistics optimization, fleet management, road infrastructure\n**âš¡ Energy & Utilities** - Grid monitoring, renewable energy planning\n\n**To give you the best recommendation, could you tell me:**\nâ€¢ What industry or sector are you in?\nâ€¢ What specific challenges are you trying to solve?\nâ€¢ Are you looking for real-time monitoring, analysis, or planning tools?\nâ€¢ What's the scale of your operation?\n\n**About Proforce Galaxies Limited:**\nWe're a leading geospatial intelligence company with over 10 years of experience in satellite imagery analysis, AI-powered solutions, and custom geospatial applications.\n\nThe more details you provide, the better I can assist you!";
    }

    // Initialize chatbot on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Auto-open chatbot after 3 seconds
      setTimeout(() => {
        if (!chatbotOpen) {
          toggleChatbot();
        }
      }, 3000);
    });
  </script>
</body>
</html>
